I"Š,<p><strong>Web Server(ì›¹ì„œë²„)ë€?</strong>
<br /></p>
<center><img src="/img/java/webServer.png" width="500" height="300" /></center>
<p><br />
ì›¹ ì‚¬ì´íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ â€˜client application, java server applicationâ€™ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì ¸ ìˆë‹¤.</p>

<p>client applicationì—ì„œ java server applicationì— ìš”ì²­ì„ ë³´ë‚´ë©´, Web serverëŠ” ìš”ì²­ì— ë§ëŠ” ë°ì´í„°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ê³ , ì •ì  í˜ì´ì§€ë¥¼ ì°¾ì•„ì„œ ë¦¬í„´í•œë‹¤.</p>

<hr />

<p><strong>WAS(Web Application Server)ë€?</strong>
<br /></p>
<center><img src="/img/java/webApplicationServer.png" width="500" height="300" /></center>
<p><br />
client applicationì—ì„œ íšŒì› ë¦¬ìŠ¤íŠ¸ë¥¼ ìš”ì²­í–ˆë‹¤ëŠ” ê°€ì •ì„ í•œë‹¤. íšŒì›ë¦¬ìŠ¤íŠ¸ëŠ” ì •ì ì¸ í˜ì´ì§€ê°€ ì•„ë‹ˆë‹¤. ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ë™ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼í•œë‹¤.</p>

<p>client applicationì—ì„œ java server applicationì— ìš”ì²­ì„ ë³´ë‚´ë©´, ì›¹ì„œë²„ëŠ” ì„œë¸”ë¦¿(ì¡°ê°ë‚˜ ìˆëŠ” ì„œë²„ ì–´í”Œë¦¬ì¼€ì´ì…˜) ì¤‘ì— ìš”ì²­ì— ë§ëŠ” íŒŒì¼ì„ ì°¾ëŠ”ë‹¤. ì—¬ê¸°ì—ëŠ” ë™ì ì¸ ìš”ì²­ì— ë¶€í•©í•˜ëŠ” ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ë°, ì´ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì´ WASì˜ ì—­í• ì´ë‹¤.</p>

<p>ë³´í†µ ìë°”ëŠ” main í•¨ìˆ˜ë¥¼ ì‹œì‘ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì´ ë™ì‘í•˜ì§€ë§Œ, servlet í”„ë¡œê·¸ë¨ì—ì„œëŠ” service í•¨ìˆ˜ë¥¼ ì‹œì‘ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì„ ë§Œë“ ë‹¤.</p>

<hr />

<p><strong>Servlet code writing and compile</strong></p>

<p>WASëŠ” HttpServletì´ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë°”ë¼ë³´ê³  ìˆë‹¤.
HttpServeletì„ í†µí•´ serviceí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•¨ìœ¼ë¡œì¨ WASì—ì„œ servlet í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•œë‹¤.</p>
<pre>
import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;

public class servletPractice extends <b>HttpServlet</b>
{
    public void service(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException
    {
        System.out.println("Hello Servlet");
    }
}
</pre>

<hr />

<p><strong>í†°ìº£, jdk, ë©”ëª¨ì¥ í™œìš©í•´ì„œ ì„œë¸”ë¦¿ í”„ë¡œê·¸ë¨ ì‘ì„±í•˜ê¸°</strong></p>

<p>1) ë©”ëª¨ì¥ì„ ì—´ì–´ ì•„ë˜ ë‚´ìš©ì„ ë¶™ì—¬ë„£ê³  servletPractice.javaë¡œ ì €ì¥í•œë‹¤. (í•„ìˆ˜: class ì´ë¦„ì€ ìë°” íŒŒì¼ëª…ê³¼ ë™ì¼)</p>

<pre>
import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;

public class servletPractice extends HttpServlet
{
	public void service(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException
	{	
		PrintWriter out = response.getWriter();
		out.println("0. url-servlet mapping at tomcat web app webapps/ROOT/WEB-INF, 1. dev/jsppractice edit servletPractice.java, 2. compile, 3. copy to tomcat webapp WEB-INF classes, 4. startup or shutdown server at tomcat/bin with sudo ./startup or shutdown");
	}
}
</pre>

<p>2) ì»´íŒŒì¼í•œë‹¤.</p>

<pre>
$ javac servletPractice.java // ì—ëŸ¬ë°œìƒ
</pre>

<p>servlet libraryëŠ” jdkì— í¬í•¨ë˜ì§€ ì•ŠëŠ” libraryì´ë‹¤. ë”°ë¼ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê²½ë¡œë¥¼ ì§€ì •í•˜ëŠ” class path ì˜µì…˜ì„ ì¶”ê°€í•´ì„œ ì»´íŒŒì¼ í•´ì•¼í•œë‹¤.</p>
<pre>
$ javac -cp /Users/youngjinlee/Desktop/Dev/STS-workspace/apache-tomcat-9.0.36/lib/servlet-api.jar servletPractice.java
$ ls
servletPractice.class servletPractice.java
</pre>

<p>3) í™˜ê²½ ì„¤ì •í•˜ê¸°</p>

<p>í´ë¼ì´ì–¸íŠ¸ê°€ í†°ìº£(WAS)ì— ì •ë³´ë¥¼ ìš”ì²­í•˜ë©´ í†°ìº£ì€ ì„œë¸”ë¦¿ í”„ë¡œê·¸ë¨ì„ í†µí•´ ìš”ì²­ì— ë§ëŠ” ì •ë³´ë¥¼ ì°¾ì•„ì„œ ì‘ë‹µí•œë‹¤.
í†°ìº£ì€ ì •ë³´ë¥¼ ì°¾ê¸° ìœ„í•´ ì»´íŒŒì¼ëœ classíŒŒì¼ì„ ì°¾ëŠ”ë°, ì‚¬ìš©ìê°€ ì´ í´ë˜ìŠ¤ íŒŒì¼ì„ ì§ì ‘ ìš”ì²­í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤.
ë”°ë¼ì„œ ì‚¬ìš©ìê°€ ìš”ì²­í• ë•Œ ë„˜ê¸´ ì •ë³´ì™€ classì˜ ì •ë³´ë¥¼ ë§¤í•‘í•´ì•¼í•œë‹¤.
ì˜ˆë¥¼ ë“¤ì–´, í´ë¼ì´ì–¸íŠ¸ê°€ http://abc.com/pageName ì„ ìš”ì²­í–ˆë‹¤ë©´, web.xml íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•´ì£¼ì–´ì•¼í•œë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;servlet&gt;
    &lt;servlet-name&gt;mappingName&lt;/servlet-name&gt;
    &lt;servlet-class&gt;servletPractice&lt;/servlet-class&gt;
&lt;/servlet&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;mappingName&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/pageName&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</code></pre></div></div>

<p>WEB-INFì•„ë˜ classes í´ë”ë¥¼ ë§Œë“¤ê³  servletPractice.classë¥¼ ë³µì‚¬í•´ ë„£ëŠ”ë‹¤. WEB-INFëŠ” ì•„ë˜ ê²½ë¡œì— ìˆìœ¼ë©°, í´ë”ëª…ì€ ì •í™•íˆ classesì—¬ì•¼í•œë‹¤.</p>

<p>â€» ì™¸ë¶€ì—ì„œëŠ” WEB-INF ì•ˆì— ìˆëŠ” íŒŒì¼ì— ëŒ€í•´ ì ˆëŒ€ë¡œ ì§ì ‘ ìš”ì²­í•  ìˆ˜ ì—†ë‹¤.</p>
<pre>
/Users/youngjinlee/Desktop/Dev/STS-workspace/apache-tomcat-9.0.36/webapps/ROOT/WEB-INF/classes
</pre>
<pre>
$ ls
servletPractice.class
</pre>

<p>4) ë§¤í•‘ì •ë³´ ì¶”ê°€í•˜ê¸°</p>

<p>ì•„ë˜ ê²½ë¡œì— ê°€ë©´ web.xml íŒŒì¼ì´ ìˆë‹¤. íŒŒì¼ ì•ˆì— ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë˜ ê²ƒì²˜ëŸ¼ ë§¤í•‘ ì •ë³´ë¥¼ ì¶”ê°€í•œë‹¤.</p>
<pre>
/Users/youngjinlee/Desktop/Dev/STS-workspace/apache-tomcat-9.0.36/webapps/ROOT/WEB-INF
</pre>
<pre>
$ cat web.xml   
<?xml version="1.0" encoding="UTF-8"?>
<!--
 Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd" version="4.0" metadata-complete="true">
  <servlet>
    <servlet-name>servletPractice_mapping_name</servlet-name>
    <servlet-class>servletPractice</servlet-class>
  </servlet>
  
  <servlet-mapping>
    <servlet-name>servletPractice_mapping_name</servlet-name>
    <url-pattern>/hello</url-pattern>
  </servlet-mapping>


  <display-name>Welcome to Tomcat</display-name>
  <description>
     Welcome to Tomcat
  </description>

</web-app>

</pre>

<p>5) í†°ìº£ ì‹¤í–‰í•˜ê¸°</p>

<p>ì•„ë˜ í´ë”ì— ê°€ë©´ startup.sh íŒŒì¼ì´ ìˆë‹¤.</p>
<pre>
$ pwd 
/Users/youngjinlee/Desktop/Dev/STS-workspace/apache-tomcat-9.0.36/bin
$ ls
bootstrap.jar                makebase.sh
catalina-tasks.xml           setclasspath.bat
catalina.bat                 setclasspath.sh
catalina.sh                  shutdown.bat
ciphers.bat                  shutdown.sh
ciphers.sh                   startup.bat
commons-daemon-native.tar.gz startup.sh
commons-daemon.jar           tomcat-juli.jar
configtest.bat               tomcat-native.tar.gz
configtest.sh                tool-wrapper.bat
daemon.sh                    tool-wrapper.sh
digest.bat                   version.bat
digest.sh                    version.sh
makebase.bat
</pre>

<p>ì‹¤í–‰í•œë‹¤. (ì„œë²„ ì¢…ë£ŒëŠ” shutdown.shë¥¼ í™œìš©í•œë‹¤.)</p>
<pre>
$ sudo ./startup.sh
Password:
Using CATALINA_BASE:   /Users/youngjinlee/Desktop/dev/STS-workspace/apache-tomcat-9.0.36
Using CATALINA_HOME:   /Users/youngjinlee/Desktop/dev/STS-workspace/apache-tomcat-9.0.36
Using CATALINA_TMPDIR: /Users/youngjinlee/Desktop/dev/STS-workspace/apache-tomcat-9.0.36/temp
Using JRE_HOME:        /Library/Java/JavaVirtualMachines/jdk-14.0.1.jdk/Contents/Home
Using CLASSPATH:       /Users/youngjinlee/Desktop/dev/STS-workspace/apache-tomcat-9.0.36/bin/bootstrap.jar:/Users/youngjinlee/Desktop/dev/STS-workspace/apache-tomcat-9.0.36/bin/tomcat-juli.jar
Tomcat started.
</pre>

<p>6) ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•œë‹¤.</p>
<pre>
http://localhost:8080/hello
</pre>

<p>6) ë§¤í•‘ì •ë³´ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ë” ê°„í¸íˆ í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì€ servlet 3.0 ë¶€í„° ê°€ëŠ¥í•˜ë‹¤.</p>

<pre>
@WebServlet("/hello")
public class servletPractice extends HttpServlet
{
	public void service(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException
	{	
		PrintWriter out = response.getWriter();
		out.println("0. url-servlet mapping at tomcat web app webapps/ROOT/WEB-INF, 1. dev/jsppractice edit servletPractice.java, 2. compile, 3. copy to tomcat webapp WEB-INF classes, 4. startup or shutdown server at tomcat/bin with sudo ./startup or shutdown");
	}
}
</pre>

<p>ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” web.xmlì˜ ì„¤ì •ì„ ë°”ê¾¸ì–´ì•¼í•œë‹¤. ë§¤í•‘ì •ë³´ë¥¼ web.xmlì—ì„œ ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ë°©ë²•(ì–´ë…¸í…Œì´ì…˜)ìœ¼ë¡œë„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒì´ë‹¤. ê¸°ë³¸ê°’ìœ¼ë¡œ trueì¸ ê²ƒì„ falseë¡œ ë°”ê¾¼ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
  version="4.0"
  metadata-complete="false"&gt;
</code></pre></div></div>

<hr />

<p><strong>TIPS</strong></p>

<p><strong>You can create any files(eg. txt) and see them with the server</strong> <br />
/Users/youngjinlee/Desktop/dev/STS-workspace-practice/apache-tomcat-9.0.36/webapps/ROOT/sample.txt
http:localhost:8080.sample.txt</p>

<p><strong>tomcat startup.sh, shutdown.sh location</strong>
/Users/youngjinlee/Desktop/dev/STS-workspace-practice/apache-tomcat-9.0.36/bin</p>

<h4>7.  java files can be located anywhere. should be compiled with â€˜javacâ€™</h4>
<h4>8. compile with servlet-api.jar to load the libraries to be imported.</h4>
<p>javac -cp /Users/youngjinlee/Desktop/dev/STS-workspace-practice/apache-tomcat-9.0.36/lib/servlet-api.jar servletPractice.java</p>

<h4>9. Where web.xml is located(HOME DIRECTORY OF TOMCAT). You need to do servlet mapping in this file.</h4>
<p>/Users/youngjinlee/Desktop/dev/STS-workspace-practice/apache-tomcat-9.0.36/webapps/ROOT/WEB-INF</p>

<h4>10. The class file needs to be copied in the HOME DIRECTORY</h4>
<p>/Users/youngjinlee/Desktop/dev/STS-workspace-practice/apache-tomcat-9.0.36/webapps/ROOT/WEB-INF/classes</p>

<h4>11. ìƒíƒœ ê°’ ìœ ì§€í•˜ê¸°</h4>
<ol>
  <li>application (with servlet context( = application ì €ì¥ì†Œ)) : ì„œë²„ìª½ì— ì €ì¥</li>
  <li>session (= application ì €ì¥ì†Œ + session id, í—¬ìŠ¤ì¥ì— ì‚¬ë¬¼í•¨ ë²ˆí˜¸ë¥¼ ë¶€ì—¬ë°›ê³  ìƒ´í‘¸ë¥¼ êº¼ë‚´ ì“°ëŠ” ê²ƒ)</li>
  <li>
    <p>cookie (í—¬ìŠ¤ì¥ì— ìƒ´í‘¸ë¥¼ ë“¤ê³ ë‹¤ë‹ˆëŠ”ê²ƒ ): í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì €ì¥í•˜ê³  ìˆìŒ. ì„œë²„ìª½ì—ì„œëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ ì„¸ì…˜ì— ì €ì¥í•˜ì§€ ì•ŠìŒ.</p>

    <ul>
      <li>í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ìš”ì²­ì„ ë³´ëƒˆì„ë•Œ ì„œë²„ì—ì„œ ê·¸ ë°ì´í„°ë¥¼ êº¼ë‚´ëŠ” ë°©ë²•</li>
      <li>ë¸Œë¼ìš°ì €ê°€ ì•Œì•„ì„œ ë‹´ì•„ì£¼ëŠ” í—¤ë” ì •ë³´: getHeader(â€œremote-hostâ€)</li>
      <li>ì¿ í‚¤: getCookies()</li>
      <li>ì‚¬ìš©ìê°€ ë³´ë‚´ëŠ” ë°ì´í„° (ë°ì´í„° ì„¤ì •): getParameter(â€œxâ€)</li>
      <li>ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µí• ë•Œ ì¿ í‚¤ë¥¼ ë³´ë‚´ëŠ”ë°©ë²•</li>
      <li>ì¿ í‚¤: addCookie()</li>
    </ul>
  </li>
</ol>

<p>â€» ì†ŒìŠ¤ ìœ„ì¹˜: ì•„ë˜ íŒŒì¼ ì €ì¥ì†Œ ì˜ /xxxx í´ë”</p>
:ET